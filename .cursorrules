# Cursor Rules for Spetalier Project

## File Organization
- Use `./.temp/cursor/` directory for temporary testing files
- Never use root `.temp/` directory for test files
- Keep test files organized and separate from production temp files
- **ALWAYS** do adhoc cursor work in `./.temp/cursor/` directory
- Never create temporary files in project root

## Code Standards
- Follow lean, maintainable, and extensible architecture principles
- Use comprehensive testing for all functionality
- Fix bugs completely before moving to new features
- Document all public methods with proper docstrings
- Use type hints throughout the codebase

## Interface Compliance
- **ALWAYS make services explicitly inherit from their interfaces** - Services must inherit from both BaseService and their interface (e.g., `class MetadataService(BaseService, IMetadataService)`)
- **ALWAYS update interfaces immediately when changing method signatures** - When refactoring service methods, update the corresponding interface in `core/interfaces.py` at the same time
- **ALWAYS verify interface compliance** - Python ABC will enforce that all abstract methods are implemented with correct signatures when services inherit from interfaces
- Interface inheritance ensures runtime type checking and prevents signature mismatches

## Testing Standards
- **ALWAYS run tests after making major changes** - Never skip test runs
- **ALWAYS add new tests for new functionality** - Every new feature needs tests
- **ALWAYS align/update existing tests when refactoring** - Keep tests in sync with code changes
- Create comprehensive test cases for bug reproduction
- Test edge cases and error conditions
- Verify fixes with multiple test scenarios
- Clean up test files after completion
- Keep tests aligned with code changes - if you change code, update tests accordingly

## Bug Fixing Process
1. Reproduce the bug with a minimal test case
2. Identify the root cause through systematic analysis
3. Implement a comprehensive fix
4. Test the fix thoroughly
5. Verify no regressions are introduced

## No Workarounds Policy
- **NEVER** create workarounds, bypasses, or temporary solutions
- **ALWAYS** fix the root cause properly
- **ALWAYS** make things work correctly, not "good enough"
- If dependencies are missing, install them properly
- If tests fail, fix the tests and code properly
- If imports fail, fix the import structure properly
- Do not create standalone test files to bypass conftest
- Do not skip tests or mark them as expected failures
- Do not use try/except to hide real problems

## Release Process
- **ALWAYS use the release script**: `./scripts/release.sh`
- **MUST be on main branch** - releases only happen from main
- Release process:
  1. Merge feature branch to main
  2. Switch to main: `git checkout main && git pull`
  3. Update version in `pyproject.toml`
  4. Update `CHANGELOG.md` with release notes (format: `## [0.1.0] - YYYY-MM-DD`)
  5. Commit changes
  6. Run `./scripts/release.sh` (runs tests, creates tag, pushes to trigger GitHub Actions)
  7. Wait for GitHub Actions to complete (creates GitHub Release)
  8. Run `./scripts/update_homebrew.sh v0.1.0` (updates Formula/spatelier.rb with SHA256)
  9. Commit and push formula update
- **The release script automatically runs tests** - tests must pass before release
- Tag format must be `v*.*.*` (e.g., `v0.1.0`, `v1.2.3`) to trigger release workflow
- Pre-releases (alpha/beta/rc) won't publish to PyPI automatically
- Homebrew formula URL format: `https://github.com/galenspikes/spatelier/archive/refs/tags/v0.1.0.tar.gz`
- Homebrew installation: `brew install --build-from-source https://raw.githubusercontent.com/galenspikes/spatelier/main/Formula/spatelier.rb`
